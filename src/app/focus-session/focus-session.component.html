<app-top-bar></app-top-bar>

<div class="session-page">
  <div class="session-card">

    <div class="circle-wrapper">
      <svg class="progress-ring" viewBox="0 0 120 120">
        <circle class="progress-ring__background" cx="60" cy="60" r="52"></circle>
        <circle
          class="progress-ring__progress"
          cx="60" cy="60" r="52"
          [attr.stroke-dasharray]="circleCircumference"
          [attr.stroke-dashoffset]="(1 - progress) * circleCircumference"
        ></circle>
      </svg>

      <div class="circle-content">
        <!-- ðŸŒ± PLANT EMOJI INSIDE CIRCLE -->
        <div 
          class="plant-wrapper"
          [style.transform]="'scale(' + plantScale + ')'"
          [class.pop]="justEvolved"
        >
          <ng-container [ngSwitch]="plantStage">
            <div *ngSwitchCase="'sprout'" class="sprout-wiggle plant-emoji">ðŸŒ±</div>
            <div *ngSwitchCase="'plant'" class="plant-breathe plant-sway plant-emoji">ðŸŒ¿</div>
            <div *ngSwitchCase="'tree'" class="tree-sway tree-canopy-pulse plant-emoji">ðŸŒ³</div>
          </ng-container>

          <!-- ðŸŒ± Ground patch -->
          <div class="ground"></div>
        </div>
      </div>
    </div>

    <!-- â±ï¸ TIME BELOW CIRCLE ONLY WHEN RUNNING -->
    <div class="running-time" *ngIf="timerRunning">
      {{ formatTime(timeLeft) }}
    </div>

    <!-- â±ï¸ TIME + ADJUST BUTTONS ONLY BEFORE START -->
    <div class="timer-controls" *ngIf="!timerRunning">
      <button class="adjust-btn" (click)="adjustTime(-5)">âˆ’</button>

      <div class="duration-display">
        {{ formatTime(timeLeft) }}
      </div>

      <button class="adjust-btn" (click)="adjustTime(5)">+</button>
    </div>

    <div class="actions">
      <button *ngIf="!timerRunning" class="start-btn" (click)="startTimer()">Plant</button>
      <button *ngIf="timerRunning" class="cancel-btn" (click)="cancelSession()">Cancel</button>
    </div>

  </div>
</div>